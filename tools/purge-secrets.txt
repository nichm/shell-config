# =============================================================================
# âš ï¸ GIT-SECRETS PURGE PATTERNS (History Cleaning)
# =============================================================================
# WARNING: These patterns are for removing secrets from git history
# REWRITING GIT HISTORY IS DESTRUCTIVE - Use with extreme caution!
#
# Format: BFG Repo-Cleaner compatible replacement patterns
# Usage: bfg --replace-text purge.txt your-repo.git
# Last Updated: 2026-01-28
# =============================================================================

# =============================================================================
# ðŸ”‘ AI PROVIDER API KEYS
# =============================================================================

# OpenAI API Keys
regex:sk-[a-zA-Z0-9]{20}T3BlbkFJ[a-zA-Z0-9]{20}==>***OPENAI_KEY_REMOVED***
regex:sk-proj-[a-zA-Z0-9_-]{48,}==>***OPENAI_PROJECT_KEY_REMOVED***

# Anthropic API Keys
regex:sk-ant-[a-zA-Z0-9_-]{95,}==>***ANTHROPIC_KEY_REMOVED***

# OpenRouter API Keys
regex:sk-or-[a-zA-Z0-9_-]{40,}==>***OPENROUTER_KEY_REMOVED***

# Groq API Keys
regex:gsk_[a-zA-Z0-9]{52}==>***GROQ_KEY_REMOVED***

# Hugging Face Tokens
regex:hf_[a-zA-Z0-9]{34}==>***HUGGINGFACE_TOKEN_REMOVED***

# =============================================================================
# â˜ï¸ CLOUD PROVIDER KEYS
# =============================================================================

# AWS Access Key IDs
regex:AKIA[0-9A-Z]{16}==>***AWS_ACCESS_KEY_REMOVED***

# AWS Secret Access Keys (40-char)
regex:[A-Za-z0-9/+=]{40}==>***AWS_SECRET_KEY_REMOVED***

# Google Cloud API Keys
regex:AIza[0-9A-Za-z\-_]{35}==>***GOOGLE_API_KEY_REMOVED***

# DigitalOcean Tokens
regex:dop_v1_[a-f0-9]{64}==>***DIGITALOCEAN_TOKEN_REMOVED***
regex:doo_v1_[a-f0-9]{64}==>***DIGITALOCEAN_OAUTH_REMOVED***

# =============================================================================
# ðŸ’³ PAYMENT PROVIDERS
# =============================================================================

# Stripe Live Keys
regex:sk_live_[0-9a-zA-Z]{24,99}==>***STRIPE_SECRET_KEY_REMOVED***
regex:pk_live_[0-9a-zA-Z]{24,99}==>***STRIPE_PUBLIC_KEY_REMOVED***
regex:rk_live_[0-9a-zA-Z]{24,99}==>***STRIPE_RESTRICTED_KEY_REMOVED***
regex:whsec_[a-zA-Z0-9]{32}==>***STRIPE_WEBHOOK_SECRET_REMOVED***

# =============================================================================
# ðŸ“§ EMAIL/COMMUNICATION SERVICES
# =============================================================================

# SendGrid API Keys
regex:SG\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9_-]{43}==>***SENDGRID_KEY_REMOVED***

# Mailchimp API Keys
regex:[a-f0-9]{32}-us[0-9]{1,2}==>***MAILCHIMP_KEY_REMOVED***

# Mailgun API Keys
regex:key-[a-zA-Z0-9]{32}==>***MAILGUN_KEY_REMOVED***

# Twilio Credentials
regex:AC[a-f0-9]{32}==>***TWILIO_SID_REMOVED***
regex:SK[a-f0-9]{32}==>***TWILIO_KEY_REMOVED***

# =============================================================================
# ðŸ’¬ MESSAGING/COLLABORATION
# =============================================================================

# Slack Tokens
regex:xox[baprs]-[0-9]{10,12}-[0-9]{10,12}-[a-zA-Z0-9]{24,}==>***SLACK_TOKEN_REMOVED***
regex:xapp-[0-9]-[A-Z0-9]{11}-[0-9]{13}-[a-f0-9]{64}==>***SLACK_APP_TOKEN_REMOVED***

# Discord Tokens
regex:[MN][A-Za-z\d]{23,}\.[\w-]{6}\.[\w-]{27,}==>***DISCORD_TOKEN_REMOVED***

# Telegram Bot Tokens
regex:[0-9]{8,10}:[a-zA-Z0-9_-]{35}==>***TELEGRAM_TOKEN_REMOVED***

# =============================================================================
# ðŸ”§ DEVELOPER TOOLS
# =============================================================================

# GitHub Tokens (All Types)
regex:ghp_[A-Za-z0-9]{36}==>***GITHUB_PAT_REMOVED***
regex:gho_[A-Za-z0-9]{36}==>***GITHUB_OAUTH_REMOVED***
regex:ghu_[A-Za-z0-9]{36}==>***GITHUB_USER_REMOVED***
regex:ghs_[A-Za-z0-9]{36}==>***GITHUB_SERVER_REMOVED***
regex:ghr_[A-Za-z0-9]{36}==>***GITHUB_REFRESH_REMOVED***
regex:github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59}==>***GITHUB_FINE_GRAINED_PAT_REMOVED***

# GitLab Tokens
regex:glpat-[a-zA-Z0-9_-]{20,}==>***GITLAB_PAT_REMOVED***

# npm Tokens
regex:npm_[a-zA-Z0-9]{36}==>***NPM_TOKEN_REMOVED***

# PyPI Tokens
regex:pypi-AgEIcHlwaS5vcmc[A-Za-z0-9_-]{50,}==>***PYPI_TOKEN_REMOVED***

# =============================================================================
# ðŸ” PRIVATE KEYS
# =============================================================================

# RSA Private Keys (replace entire key block)
regex:-----BEGIN RSA PRIVATE KEY-----[\s\S]*?-----END RSA PRIVATE KEY-----==>***RSA_PRIVATE_KEY_REMOVED***

# Generic Private Keys
regex:-----BEGIN PRIVATE KEY-----[\s\S]*?-----END PRIVATE KEY-----==>***PRIVATE_KEY_REMOVED***

# OpenSSH Private Keys
regex:-----BEGIN OPENSSH PRIVATE KEY-----[\s\S]*?-----END OPENSSH PRIVATE KEY-----==>***OPENSSH_KEY_REMOVED***

# EC Private Keys
regex:-----BEGIN EC PRIVATE KEY-----[\s\S]*?-----END EC PRIVATE KEY-----==>***EC_PRIVATE_KEY_REMOVED***

# PGP Private Keys
regex:-----BEGIN PGP PRIVATE KEY BLOCK-----[\s\S]*?-----END PGP PRIVATE KEY BLOCK-----==>***PGP_KEY_REMOVED***

# =============================================================================
# ðŸ—„ï¸ DATABASE CREDENTIALS
# =============================================================================

# MongoDB Connection Strings with Credentials
regex:mongodb(\+srv)?://[^:]+:[^@]+@==>mongodb://***REMOVED***@

# PostgreSQL Connection Strings with Credentials
regex:postgres(ql)?://[^:]+:[^@]+@==>postgresql://***REMOVED***@

# MySQL Connection Strings with Credentials
regex:mysql://[^:]+:[^@]+@==>mysql://***REMOVED***@

# Redis URLs with Credentials
regex:redis(s)?://[^:]+:[^@]+@==>redis://***REMOVED***@

# =============================================================================
# ðŸ“¦ ADDITIONAL SERVICES
# =============================================================================

# Heroku API Keys
regex:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}==>***UUID_REMOVED***

# Sentry DSN
regex:https://[a-f0-9]{32}@[^/]+\.ingest\.sentry\.io/[0-9]+==>***SENTRY_DSN_REMOVED***

# =============================================================================
# USAGE INSTRUCTIONS
# =============================================================================
#
# 1. FIRST: Rotate all compromised credentials immediately!
#
# 2. Scan repository for secrets:
#    git secrets --scan-history 2>&1 | tee secrets-found.txt
#
# 3. Review what was found:
#    cat secrets-found.txt
#
# 4. Create backup of repository:
#    git clone --mirror your-repo.git backup-repo.git
#
# 5. Use BFG Repo-Cleaner (fastest method):
#    # Install: brew install bfg
#    bfg --replace-text purge.txt your-repo.git
#
# 6. Clean up refs and garbage collect:
#    cd your-repo.git
#    git reflog expire --expire=now --all
#    git gc --prune=now --aggressive
#
# 7. Force push changes (DANGEROUS - coordinate with team):
#    git push origin --force --all
#    git push origin --force --tags
#
# 8. Notify all team members to re-clone the repository
#
# 9. CRITICAL: Rotate ALL exposed credentials!
#    - AWS: Deactivate old key, create new key
#    - GitHub: Regenerate token
#    - API Keys: Regenerate in respective dashboards
#
# Alternative: Use git-filter-repo (modern approach):
#    pip install git-filter-repo
#    git filter-repo --replace-text purge.txt
#
# =============================================================================
# NOTES
# =============================================================================
#
# - BFG format: regex:PATTERN==>REPLACEMENT
# - Patterns must match exactly what's in the file
# - Test on a clone first, not your main repo
# - History rewriting affects all clones - coordinate with team
# - Consider using GitHub's secret scanning alerts instead
#
# =============================================================================
